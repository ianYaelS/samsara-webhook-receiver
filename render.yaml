databases:

name: samsara-db
plan: free
region: oregon
postgresMajorVersion: 14

services:

type: web
name: samsara-webhook
env: python
pythonVersion: "3.10.13"
plan: free
region: oregon
autoSuspend: false
healthCheckPath: /docs
buildCommand: "pip install -r requirements.txt"
startCommand: "uvicorn webhook_receiver:app --host 0.0.0.0 --port $PORT"
routes:

src: /webhook-samsara
dest: /webhook
envVars:

key: DATABASE_URL
fromService:
type: postgres
name: samsara-db
property: connectionString

key: SAMSARA_WEBHOOK_SECRET
sync: false

type: web
name: samsara-dashboard
env: python
pythonVersion: "3.10.13"
plan: free
region: oregon
autoSuspend: false
healthCheckPath: /_stcore/health
buildCommand: "pip install -r requirements.txt"
startCommand: "streamlit run streamlit_app.py --server.port $PORT --server.enableCORS false --server.enableXsrfProtection false"
envVars:

key: DATABASE_URL
fromService:
type: postgres
name: samsara-db
property: connectionString

key: SAMSARA_API_KEY
sync: false
